node {
    def dimg
    def bimg

    stage('Clone repository') {
        checkout scm

        sh 'docker volume create vol-in'
        sh 'docker volume create vol-out'
        sh 'docker volume ls'

        sh 'docker run -d --rm --name dummy -v vol-in:/vi alpine tail -f /dev/null'
        sh 'docker cp . dummy:/vi'
        sh 'docker stop dummy'
    }

    stage('Dependency image') {
        //dimg = docker.build("dependency-image", "./CI/dependencies")
        docker.image('node:latest').inside('-v vol-in:/vi -v vol-out:/vo') {
        sh 'ls -al'
        }
    }
    
    //stage('Build iamge'){
    //    sh 'docker volume ls'
    //    docker.image('dependency-image:latest').withRun('-v vol-in:/vi -v vol-out:/vo') { c ->
    //    sh 'ls -al'
    //    sh 'tree'
        //sh 'touch aaa'
        //sh 'cp aaa ./vi'
    //}
    //}
}